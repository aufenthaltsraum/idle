var AI={};AI.People=function(a){var b=0;this.who=a.map(function(a){return{id:b++,occupation:a}});this.nextId=b;this.occupations={};for(a=0;a<AI.People.occupationList.length;a++)this.occupations[AI.People.occupationList[a].tag]=this.occupiedWith(AI.People.occupationList[a].tag)};AI.People.prototype.addPerson=function(a){var b=this.nextId;this.who[this.who.length]={id:b++,occupation:a};this.nextId=b;this.occupations[a]++;this.draw();return this};
AI.People.prototype.occupiedWith=function(a){var b,c=0;for(b=0;b<this.who.length;b++)this.who[b].occupation==a&&c++;return c};AI.People.prototype.changeOccupation=function(a,b){var c;for(c=0;c<this.who.length;c++)if(this.who[c].id==a)return this.occupations[this.who[c].occupation]--,this.who[c].occupation=b,this.occupations[this.who[c].occupation]++,this.draw(),a};
AI.People.prototype.draw=function(){$(".person").remove();for(i=0;i<this.who.length;i++){var a,b='<li class="person">',c="";for(a=0;a<AI.People.occupationList.length;a++)this.who[i].occupation==AI.People.occupationList[a].tag?b+=AI.People.occupationList[a].description:c+=" <a onclick="+('"AI.state.people.changeOccupation('+this.who[i].id+",'"+AI.People.occupationList[a].tag+"')\"")+' href="#">'+AI.People.occupationList[a].tag+"</a>";b+=c+"</li>";$("#people").append(b)}};
AI.People.occupationList=[{tag:"exc",description:"solving exercises"},{tag:"tea",description:"buying tea"}];AI.State=function(){this.exercises=0;this.people=new AI.People(["exc","exc"]);this.tea=5;this.cups=this.drinkingTea=0;this.update=new Date};AI.tick=function(){var a=new Date,b=AI.state,c=a-b.update;b.update=a;b.exercises+=c/(0<b.drinkingTea?1E3:5E3)*b.people.occupations.exc;$("#exercises").html(Math.floor(b.exercises));b.tea+=c/5E3*b.people.occupations.tea;$("#tea").html(Math.floor(b.tea));b.drinkingTea-=c;0<b.drinkingTea?(a="(drinking for "+Math.floor(b.drinkingTea/1E3)+" more seconds)",c=$("#drinking-tea"),c.length?c.html(a):$("#tea-container").append('<a id="drinking-tea">'+a+"</a>")):1<=b.tea&&!$("#drink-tea").length&&$("#tea-container").append('<a id="drink-tea" onclick="AI.actions.drinkTea()" href="#">drink some</a>');
0>=b.drinkingTea&&($("#drinking-tea").remove(),b.drinkingTea=0)};AI.actions={drinkTea:function(){var a=AI.state;return 1<=a.tea&&0>=a.drinkingTea?(--a.tea,a.cups+=1,$("#cups").html(Math.floor(a.cups)),a.drinkingTea=6E4,$("#drink-tea").remove(),!0):!1}};AI.state=new AI.State;$(document).ready(function(){AI.state.people.draw();AI.interval=window.setInterval(AI.tick,100)});
